this is core file from masterbranch
this is changes from r2
