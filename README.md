this is core file from masterbranch
